<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1295px" height="321px" viewBox="-0.5 -0.5 1295 321" content="&lt;mxfile host=&quot;Electron&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/24.7.17 Chrome/128.0.6613.36 Electron/32.0.1 Safari/537.36&quot; version=&quot;24.7.17&quot;&gt;&#10;  &lt;diagram name=&quot;ページ1&quot; id=&quot;QouTJwwNm7_lFS2_8LnF&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;127&quot; dy=&quot;1759&quot; grid=&quot;1&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;1&quot; pageScale=&quot;1&quot; pageWidth=&quot;827&quot; pageHeight=&quot;1169&quot; math=&quot;1&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;eTVYUTHbzLHcPZ9Aj4pK-8&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;dashed=1;&quot; parent=&quot;1&quot; source=&quot;YbIgwRWNWmnF1qLJX9Vr-2&quot; target=&quot;eTVYUTHbzLHcPZ9Aj4pK-6&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;YbIgwRWNWmnF1qLJX9Vr-2&quot; value=&quot;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=none;strokeWidth=3;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1150&quot; y=&quot;74&quot; width=&quot;340&quot; height=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;M10dwMqMZfZ2SX4azHTq-38&quot; value=&quot;&quot; style=&quot;group&quot; parent=&quot;1&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;970&quot; y=&quot;110&quot; width=&quot;120&quot; height=&quot;84&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;M10dwMqMZfZ2SX4azHTq-44&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;&quot; parent=&quot;M10dwMqMZfZ2SX4azHTq-38&quot; source=&quot;M10dwMqMZfZ2SX4azHTq-29&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;380&quot; y=&quot;34&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;M10dwMqMZfZ2SX4azHTq-29&quot; value=&quot;&quot; style=&quot;shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;M10dwMqMZfZ2SX4azHTq-38&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;14&quot; width=&quot;120&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;M10dwMqMZfZ2SX4azHTq-30&quot; value=&quot;&quot; style=&quot;shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;M10dwMqMZfZ2SX4azHTq-38&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;120&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;M10dwMqMZfZ2SX4azHTq-60&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; source=&quot;M10dwMqMZfZ2SX4azHTq-43&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1190&quot; y=&quot;277&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;YbIgwRWNWmnF1qLJX9Vr-1&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;fillColor=#f8cecc;strokeColor=#b85450;endArrow=none;endFill=0;startArrow=classic;startFill=1;&quot; parent=&quot;1&quot; source=&quot;M10dwMqMZfZ2SX4azHTq-43&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1189.8571428571431&quot; y=&quot;-1.1368683772161603e-13&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;M10dwMqMZfZ2SX4azHTq-43&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;モデル `f_\theta`&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1160&quot; y=&quot;110&quot; width=&quot;120&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;M10dwMqMZfZ2SX4azHTq-47&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;fillColor=#d5e8d4;strokeColor=#82b366;&quot; parent=&quot;1&quot; source=&quot;M10dwMqMZfZ2SX4azHTq-45&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1190&quot; y=&quot;220&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;1410&quot; y=&quot;200&quot; /&gt;&#10;              &lt;mxPoint x=&quot;1220&quot; y=&quot;200&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;M10dwMqMZfZ2SX4azHTq-48&quot; value=&quot;&amp;lt;font color=&amp;quot;#009900&amp;quot; style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;&amp;quot;&amp;gt;`\theta` を更新&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;M10dwMqMZfZ2SX4azHTq-47&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.0531&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;M10dwMqMZfZ2SX4azHTq-45&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;ロス関数 `l`&amp;lt;/font&amp;gt;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1350&quot; y=&quot;100&quot; width=&quot;120&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;M10dwMqMZfZ2SX4azHTq-46&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.855;exitY=0;exitDx=0;exitDy=4.35;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;&quot; parent=&quot;1&quot; source=&quot;M10dwMqMZfZ2SX4azHTq-30&quot; target=&quot;M10dwMqMZfZ2SX4azHTq-45&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;1073&quot; y=&quot;80&quot; /&gt;&#10;              &lt;mxPoint x=&quot;1410&quot; y=&quot;80&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;M10dwMqMZfZ2SX4azHTq-71&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;`N_\text{batch}` 個のデータ&amp;lt;/font&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;885&quot; y=&quot;50&quot; width=&quot;270&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;YbIgwRWNWmnF1qLJX9Vr-16&quot; value=&quot;&amp;lt;pre style=&amp;quot;padding: 0.8em; overflow: auto; line-height: 1.4; border: rgb(214, 214, 214); border-radius: 3px; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-family: Consolas, &amp;amp;quot;Liberation Mono&amp;amp;quot;, Menlo, Courier, monospace; text-align: left; word-break: normal; overflow-wrap: normal; tab-size: 8; hyphens: none; font-size: 24px;&amp;quot; class=&amp;quot;language-python&amp;quot; data-info=&amp;quot;python&amp;quot; data-role=&amp;quot;codeBlock&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/pre&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1000&quot; y=&quot;94&quot; width=&quot;60&quot; height=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;YbIgwRWNWmnF1qLJX9Vr-17&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#999999&amp;quot; face=&amp;quot;Courier New&amp;quot;&amp;gt;&amp;lt;b&amp;gt;# 誤差逆伝播法のための記憶処理&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot; face=&amp;quot;Courier New&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;&amp;quot;&amp;gt;with tf.GradientTape() as tape:&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;b style=&amp;quot;font-size: 20px; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; background-color: initial;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;white-space-collapse: preserve;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b style=&amp;quot;font-size: 20px; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; background-color: initial;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#b85450&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; y_pred = &amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;font-size: 20px; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; background-color: initial;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#b85450&amp;quot;&amp;gt;model(&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;font-size: 20px; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; background-color: rgb(153, 204, 255);&amp;quot;&amp;gt;X&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;font-size: 20px; color: rgb(0, 0, 255); font-family: &amp;amp;quot;Courier New&amp;amp;quot;; background-color: initial;&amp;quot;&amp;gt;, &amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;font-size: 20px; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; background-color: initial;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#b85450&amp;quot;&amp;gt;training=True&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;font-size: 20px; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; background-color: initial;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#b85450&amp;quot;&amp;gt;)&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font face=&amp;quot;Courier New&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;&amp;amp;nbsp;loss_value =&amp;lt;font color=&amp;quot;#0000ff&amp;quot;&amp;gt; &amp;lt;/font&amp;gt;loss_fn(&amp;lt;span style=&amp;quot;background-color: rgb(153, 204, 255);&amp;quot;&amp;gt;y&amp;lt;/span&amp;gt;&amp;lt;font color=&amp;quot;#0000ff&amp;quot;&amp;gt;, &amp;lt;/font&amp;gt;&amp;lt;font color=&amp;quot;#b85450&amp;quot;&amp;gt;y_pred&amp;lt;/font&amp;gt;)&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1200&quot; y=&quot;-35&quot; width=&quot;460&quot; height=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;YbIgwRWNWmnF1qLJX9Vr-18&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#999999&amp;quot; face=&amp;quot;Courier New&amp;quot;&amp;gt;&amp;lt;b&amp;gt;# パラメータ更新&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;background-color: initial; color: rgb(0, 153, 0); font-family: &amp;amp;quot;Courier New&amp;amp;quot;; font-size: 20px;&amp;quot;&amp;gt;optimizer.apply_gradient(&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: initial; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#b5739d&amp;quot;&amp;gt;zip(&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: initial; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#0000ff&amp;quot;&amp;gt;grads&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: initial; color: rgb(0, 153, 0); font-family: &amp;amp;quot;Courier New&amp;amp;quot;; font-size: 20px;&amp;quot;&amp;gt;, &amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: initial; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#b85450&amp;quot;&amp;gt;model.trainable_variables&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: initial; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#b5739d&amp;quot;&amp;gt;)&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: initial; color: rgb(0, 153, 0); font-family: &amp;amp;quot;Courier New&amp;amp;quot;; font-size: 20px;&amp;quot;&amp;gt;)&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1190&quot; y=&quot;220&quot; width=&quot;780&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;eTVYUTHbzLHcPZ9Aj4pK-4&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#999999&amp;quot; face=&amp;quot;Courier New&amp;quot;&amp;gt;&amp;lt;b&amp;gt;# データ読み込み&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font face=&amp;quot;Courier New&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;background-color: rgb(153, 204, 255);&amp;quot;&amp;gt;X, y = data&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;935&quot; y=&quot;170&quot; width=&quot;190&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;eTVYUTHbzLHcPZ9Aj4pK-5&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left; font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#999999&amp;quot; face=&amp;quot;Courier New&amp;quot;&amp;gt;&amp;lt;b&amp;gt;# 勾配計算&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;text-align: left; font-size: 20px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;font-size: 20px; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; background-color: initial;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#0000ff&amp;quot;&amp;gt;grads = tape.gradient(&amp;lt;/font&amp;gt;loss_value&amp;lt;font color=&amp;quot;#0000ff&amp;quot;&amp;gt;,&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;background-color: initial; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#b85450&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; model.trainable_variables&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;font-size: 20px; font-family: &amp;amp;quot;Courier New&amp;amp;quot;; background-color: initial;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#0000ff&amp;quot;&amp;gt;)&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1580&quot; y=&quot;140&quot; width=&quot;600&quot; height=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;eTVYUTHbzLHcPZ9Aj4pK-9&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;dashed=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;eTVYUTHbzLHcPZ9Aj4pK-6&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1370&quot; y=&quot;200&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;1540&quot; y=&quot;220&quot; /&gt;&#10;              &lt;mxPoint x=&quot;1370&quot; y=&quot;220&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;eTVYUTHbzLHcPZ9Aj4pK-6&quot; value=&quot;&amp;lt;font color=&amp;quot;#0000ff&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;`\nabla_{\color{#B85450}\theta}`&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;strokeColor=#0000FF;strokeWidth=2;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1510&quot; y=&quot;150&quot; width=&quot;60&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;"><defs><style xmlns="http://www.w3.org/1999/xhtml" id="MJX-SVG-styles">&#xa;mjx-container[jax="SVG"] {&#xa;  direction: ltr;&#xa;}&#xa;&#xa;mjx-container[jax="SVG"] &gt; svg {&#xa;  overflow: visible;&#xa;  min-height: 1px;&#xa;  min-width: 1px;&#xa;}&#xa;&#xa;mjx-container[jax="SVG"] &gt; svg a {&#xa;  fill: blue;&#xa;  stroke: blue;&#xa;}&#xa;&#xa;mjx-container[jax="SVG"][display="true"] {&#xa;  display: block;&#xa;  text-align: center;&#xa;  margin: 1em 0;&#xa;}&#xa;&#xa;mjx-container[jax="SVG"][display="true"][width="full"] {&#xa;  display: flex;&#xa;}&#xa;&#xa;mjx-container[jax="SVG"][justify="left"] {&#xa;  text-align: left;&#xa;}&#xa;&#xa;mjx-container[jax="SVG"][justify="right"] {&#xa;  text-align: right;&#xa;}&#xa;&#xa;g[data-mml-node="merror"] &gt; g {&#xa;  fill: red;&#xa;  stroke: red;&#xa;}&#xa;&#xa;g[data-mml-node="merror"] &gt; rect[data-background] {&#xa;  fill: yellow;&#xa;  stroke: none;&#xa;}&#xa;&#xa;g[data-mml-node="mtable"] &gt; line[data-line], svg[data-table] &gt; g &gt; line[data-line] {&#xa;  stroke-width: 70px;&#xa;  fill: none;&#xa;}&#xa;&#xa;g[data-mml-node="mtable"] &gt; rect[data-frame], svg[data-table] &gt; g &gt; rect[data-frame] {&#xa;  stroke-width: 70px;&#xa;  fill: none;&#xa;}&#xa;&#xa;g[data-mml-node="mtable"] &gt; .mjx-dashed, svg[data-table] &gt; g &gt; .mjx-dashed {&#xa;  stroke-dasharray: 140;&#xa;}&#xa;&#xa;g[data-mml-node="mtable"] &gt; .mjx-dotted, svg[data-table] &gt; g &gt; .mjx-dotted {&#xa;  stroke-linecap: round;&#xa;  stroke-dasharray: 0,140;&#xa;}&#xa;&#xa;g[data-mml-node="mtable"] &gt; g &gt; svg {&#xa;  overflow: visible;&#xa;}&#xa;&#xa;[jax="SVG"] mjx-tool {&#xa;  display: inline-block;&#xa;  position: relative;&#xa;  width: 0;&#xa;  height: 0;&#xa;}&#xa;&#xa;[jax="SVG"] mjx-tool &gt; mjx-tip {&#xa;  position: absolute;&#xa;  top: 0;&#xa;  left: 0;&#xa;}&#xa;&#xa;mjx-tool &gt; mjx-tip {&#xa;  display: inline-block;&#xa;  padding: .2em;&#xa;  border: 1px solid #888;&#xa;  font-size: 70%;&#xa;  background-color: #F8F8F8;&#xa;  color: black;&#xa;  box-shadow: 2px 2px 5px #AAAAAA;&#xa;}&#xa;&#xa;g[data-mml-node="maction"][data-toggle] {&#xa;  cursor: pointer;&#xa;}&#xa;&#xa;mjx-status {&#xa;  display: block;&#xa;  position: fixed;&#xa;  left: 1em;&#xa;  bottom: 1em;&#xa;  min-width: 25%;&#xa;  padding: .2em .4em;&#xa;  border: 1px solid #888;&#xa;  font-size: 90%;&#xa;  background-color: #F8F8F8;&#xa;  color: black;&#xa;}&#xa;&#xa;foreignObject[data-mjx-xml] {&#xa;  font-family: initial;&#xa;  line-height: normal;&#xa;  overflow: visible;&#xa;}&#xa;&#xa;mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {&#xa;  stroke-width: 3;&#xa;}&#xa;</style></defs><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="eTVYUTHbzLHcPZ9Aj4pK-8"><g><path d="M 605 164 Q 655 164 655 178.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 655 183.88 L 651.5 176.88 L 655 178.63 L 658.5 176.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="YbIgwRWNWmnF1qLJX9Vr-2"><g><rect x="265" y="109" width="340" height="110" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/></g></g><g data-cell-id="M10dwMqMZfZ2SX4azHTq-38"><g/><g data-cell-id="M10dwMqMZfZ2SX4azHTq-44"><g><path d="M 205 179 L 335 179 L 458.63 179" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 463.88 179 L 456.88 182.5 L 458.63 179 L 456.88 175.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="M10dwMqMZfZ2SX4azHTq-29"><g><path d="M 85 174 C 85 165.72 111.86 159 145 159 C 160.91 159 176.17 160.58 187.43 163.39 C 198.68 166.21 205 170.02 205 174 L 205 184 C 205 192.28 178.14 199 145 199 C 111.86 199 85 192.28 85 184 Z" fill="#dae8fc" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all"/><path d="M 205 174 C 205 182.28 178.14 189 145 189 C 111.86 189 85 182.28 85 174" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="M10dwMqMZfZ2SX4azHTq-30"><g><path d="M 85 160 C 85 151.72 111.86 145 145 145 C 160.91 145 176.17 146.58 187.43 149.39 C 198.68 152.21 205 156.02 205 160 L 205 170 C 205 178.28 178.14 185 145 185 C 111.86 185 85 178.28 85 170 Z" fill="#dae8fc" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all"/><path d="M 205 160 C 205 168.28 178.14 175 145 175 C 111.86 175 85 168.28 85 160" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all"/></g></g></g><g data-cell-id="M10dwMqMZfZ2SX4azHTq-60"><g><path d="M 305 205 L 305 258.5 L 305 305.63" fill="none" stroke="#b85450" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 305 310.88 L 301.5 303.88 L 305 305.63 L 308.5 303.88 Z" fill="#b85450" stroke="#b85450" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="YbIgwRWNWmnF1qLJX9Vr-1"><g><path d="M 305 138.63 L 305 90.5 L 304.86 35" fill="none" stroke="#b85450" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 305 143.88 L 301.5 136.88 L 305 138.63 L 308.5 136.88 Z" fill="#b85450" stroke="#b85450" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="M10dwMqMZfZ2SX4azHTq-43"><g><rect x="275" y="145" width="120" height="60" rx="9" ry="9" fill="#f8cecc" stroke="#b85450" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 175px; margin-left: 276px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 20px;">モデル <mjx-container class="MathJax" jax="SVG"><svg xmlns="http://www.w3.org/2000/svg" width="2.047ex" height="2.059ex" role="img" focusable="false" viewBox="0 -705 904.6 910" xmlns:xlink="http://www.w3.org/1999/xlink" style="vertical-align: -0.464ex;"><defs><path id="MJX-36-TEX-I-1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"/><path id="MJX-36-TEX-I-1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D453" xlink:href="#MJX-36-TEX-I-1D453"/></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><use data-c="1D703" xlink:href="#MJX-36-TEX-I-1D703"/></g></g></g></g></g></svg></mjx-container></font></div></div></div></foreignObject><text x="335" y="179" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">モデル `f_\theta`</text></switch></g></g></g><g data-cell-id="M10dwMqMZfZ2SX4azHTq-47"><g><path d="M 525 215 Q 525 235 430 235 Q 335 235 335 245 Q 335 255 311.37 255" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 306.12 255 L 313.12 251.5 L 311.37 255 L 313.12 258.5 Z" fill="#82b366" stroke="#82b366" stroke-miterlimit="10" pointer-events="all"/></g><g data-cell-id="M10dwMqMZfZ2SX4azHTq-48"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 236px; margin-left: 423px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;"><font style="font-size: 20px;" color="#009900"><b style=""><mjx-container class="MathJax" jax="SVG"><svg xmlns="http://www.w3.org/2000/svg" width="1.061ex" height="1.618ex" role="img" focusable="false" viewBox="0 -705 469 715" xmlns:xlink="http://www.w3.org/1999/xlink" style="vertical-align: -0.023ex;"><defs><path id="MJX-37-TEX-I-1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="mi"><use data-c="1D703" xlink:href="#MJX-37-TEX-I-1D703"/></g></g></g></g></svg></mjx-container> を更新</b></font></div></div></div></foreignObject><text x="423" y="239" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">`\theta` を更新</text></switch></g></g></g></g><g data-cell-id="M10dwMqMZfZ2SX4azHTq-45"><g><ellipse cx="525" cy="175" rx="60" ry="40" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 175px; margin-left: 466px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 20px;">ロス関数 <mjx-container class="MathJax" jax="SVG"><svg xmlns="http://www.w3.org/2000/svg" width="0.674ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 298 705" xmlns:xlink="http://www.w3.org/1999/xlink" style="vertical-align: -0.025ex;"><defs><path id="MJX-38-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="mi"><use data-c="1D459" xlink:href="#MJX-38-TEX-I-1D459"/></g></g></g></g></svg></mjx-container></font></div></div></div></foreignObject><text x="525" y="179" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">ロス関数 `l`</text></switch></g></g></g><g data-cell-id="M10dwMqMZfZ2SX4azHTq-46"><g><path d="M 187.6 149.35 Q 187.6 115 356.3 115 Q 525 115 525 128.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 525 133.88 L 521.5 126.88 L 525 128.63 L 528.5 126.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="M10dwMqMZfZ2SX4azHTq-71"><g><rect x="0" y="85" width="270" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 105px; margin-left: 135px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><font style="font-size: 20px;"><mjx-container class="MathJax" jax="SVG"><svg xmlns="http://www.w3.org/2000/svg" width="5.916ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 2614.9 840.8" xmlns:xlink="http://www.w3.org/1999/xlink" style="vertical-align: -0.357ex;"><defs><path id="MJX-39-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"/><path id="MJX-39-TEX-N-62" d="M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z"/><path id="MJX-39-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"/><path id="MJX-39-TEX-N-74" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z"/><path id="MJX-39-TEX-N-63" d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z"/><path id="MJX-39-TEX-N-68" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 124T102 167T103 217T103 272T103 329Q103 366 103 407T103 482T102 542T102 586T102 603Q99 622 88 628T43 637H25V660Q25 683 27 683L37 684Q47 685 66 686T103 688Q120 689 140 690T170 693T181 694H184V367Q244 442 328 442Q451 442 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-39-TEX-I-1D441"/></g><g data-mml-node="mrow" transform="translate(836,-150) scale(0.707)"><g data-mml-node="mtext"><use data-c="62" xlink:href="#MJX-39-TEX-N-62"/><use data-c="61" xlink:href="#MJX-39-TEX-N-61" transform="translate(556,0)"/><use data-c="74" xlink:href="#MJX-39-TEX-N-74" transform="translate(1056,0)"/><use data-c="63" xlink:href="#MJX-39-TEX-N-63" transform="translate(1445,0)"/><use data-c="68" xlink:href="#MJX-39-TEX-N-68" transform="translate(1889,0)"/></g></g></g></g></g></g></svg></mjx-container> 個のデータ</font></div></div></div></foreignObject><text x="135" y="109" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">`N_\text{batch}` 個のデータ</text></switch></g></g></g><g data-cell-id="YbIgwRWNWmnF1qLJX9Vr-16"><g><rect x="115" y="129" width="60" height="100" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 179px; margin-left: 145px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><pre data-role="codeBlock" data-info="python" class="language-python" style="padding: 0.8em; overflow: auto; line-height: 1.4; border: rgb(214, 214, 214); border-radius: 3px; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; text-align: left; word-break: normal; overflow-wrap: normal; tab-size: 8; hyphens: none; font-size: 24px;"><br /></pre></div></div></div></foreignObject><text x="145" y="183" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle"></text></switch></g></g></g><g data-cell-id="YbIgwRWNWmnF1qLJX9Vr-17"><g><rect x="315" y="0" width="460" height="110" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 55px; margin-left: 317px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><div><div style="font-size: 20px;"><font face="Courier New" color="#999999"><b># 誤差逆伝播法のための記憶処理</b></font></div><div style="font-size: 20px;"></div></div><font face="Courier New" style="font-size: 20px;"><b style="">with tf.GradientTape() as tape:</b></font><b style="font-size: 20px; font-family: &quot;Courier New&quot;; background-color: initial;"><span style="white-space-collapse: preserve;">	</span></b><div><b style="font-size: 20px; font-family: &quot;Courier New&quot;; background-color: initial;"><font color="#b85450">    y_pred = </font></b><b style="font-size: 20px; font-family: &quot;Courier New&quot;; background-color: initial;"><font color="#b85450">model(</font></b><b style="font-size: 20px; font-family: &quot;Courier New&quot;; background-color: rgb(153, 204, 255);">X</b><b style="font-size: 20px; color: rgb(0, 0, 255); font-family: &quot;Courier New&quot;; background-color: initial;">, </b><b style="font-size: 20px; font-family: &quot;Courier New&quot;; background-color: initial;"><font color="#b85450">training=True</font></b><b style="font-size: 20px; font-family: &quot;Courier New&quot;; background-color: initial;"><font color="#b85450">)</font></b></div><div style="font-size: 20px;"><font face="Courier New"><b style="">    loss_value =<font color="#0000ff"> </font>loss_fn(<span style="background-color: rgb(153, 204, 255);">y</span><font color="#0000ff">, </font><font color="#b85450">y_pred</font>)</b></font></div></div></div></div></foreignObject><text x="317" y="59" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px"># 誤差逆伝播法のための記憶処理...</text></switch></g></g></g><g data-cell-id="YbIgwRWNWmnF1qLJX9Vr-18"><g><rect x="305" y="255" width="780" height="60" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 285px; margin-left: 695px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><div style="text-align: left;"><div style="font-size: 20px;"><font face="Courier New" color="#999999"><b># パラメータ更新</b></font></div><div style="font-size: 20px;"></div></div><div style="text-align: left;"><b style="background-color: initial; color: rgb(0, 153, 0); font-family: &quot;Courier New&quot;; font-size: 20px;">optimizer.apply_gradient(</b><b style="background-color: initial; font-family: &quot;Courier New&quot;; font-size: 20px;"><font color="#b5739d">zip(</font></b><b style="background-color: initial; font-family: &quot;Courier New&quot;; font-size: 20px;"><font color="#0000ff">grads</font></b><b style="background-color: initial; color: rgb(0, 153, 0); font-family: &quot;Courier New&quot;; font-size: 20px;">, </b><b style="background-color: initial; font-family: &quot;Courier New&quot;; font-size: 20px;"><font color="#b85450">model.trainable_variables</font></b><b style="background-color: initial; font-family: &quot;Courier New&quot;; font-size: 20px;"><font color="#b5739d">)</font></b><b style="background-color: initial; color: rgb(0, 153, 0); font-family: &quot;Courier New&quot;; font-size: 20px;">)</b><br /></div></div></div></div></foreignObject><text x="695" y="289" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle"># パラメータ更新...</text></switch></g></g></g><g data-cell-id="eTVYUTHbzLHcPZ9Aj4pK-4"><g><rect x="50" y="205" width="190" height="80" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 245px; margin-left: 145px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><div style="text-align: left;"><div style="font-size: 20px;"><font face="Courier New" color="#999999"><b># データ読み込み</b></font></div><div style="font-size: 20px;"><font face="Courier New"><b style="background-color: rgb(153, 204, 255);">X, y = data</b></font></div><div style="font-size: 20px;"></div></div><div style="text-align: left;"><br /></div></div></div></div></foreignObject><text x="145" y="249" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle"># データ読み込み...</text></switch></g></g></g><g data-cell-id="eTVYUTHbzLHcPZ9Aj4pK-5"><g><rect x="695" y="175" width="600" height="90" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 220px; margin-left: 995px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><div style="text-align: left; font-size: 20px;"><font face="Courier New" color="#999999"><b># 勾配計算</b></font></div><div style="text-align: left; font-size: 20px;"><div style="font-size: 12px;"><b style="font-size: 20px; font-family: &quot;Courier New&quot;; background-color: initial;"><font color="#0000ff">grads = tape.gradient(</font>loss_value<font color="#0000ff">, </font></b></div><div style="font-size: 12px;"><b style="background-color: initial; font-family: &quot;Courier New&quot;; font-size: 20px;"><font color="#b85450"><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>      model.trainable_variables</font></b><b style="font-size: 20px; font-family: &quot;Courier New&quot;; background-color: initial;"><font color="#0000ff">)</font></b></div></div></div></div></div></foreignObject><text x="995" y="224" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle"># 勾配計算...</text></switch></g></g></g><g data-cell-id="eTVYUTHbzLHcPZ9Aj4pK-9"><g><path d="M 655 235 Q 655 255 570 255 Q 485 255 485 241.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 485 236.12 L 488.5 243.12 L 485 241.37 L 481.5 243.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="eTVYUTHbzLHcPZ9Aj4pK-6"><g><ellipse cx="655" cy="210" rx="30" ry="25" fill="rgb(255, 255, 255)" stroke="#0000ff" stroke-width="2" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 210px; margin-left: 626px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#0000ff"><span style="font-size: 17px;"><mjx-container class="MathJax" jax="SVG"><svg xmlns="http://www.w3.org/2000/svg" width="2.823ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1247.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" style="vertical-align: -0.355ex;"><defs><path id="MJX-40-TEX-N-2207" d="M46 676Q46 679 51 683H781Q786 679 786 676Q786 674 617 326T444 -26Q439 -33 416 -33T388 -26Q385 -22 216 326T46 676ZM697 596Q697 597 445 597T193 596Q195 591 319 336T445 80L697 596Z"/><path id="MJX-40-TEX-I-1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="msub"><g data-mml-node="mo"><use data-c="2207" xlink:href="#MJX-40-TEX-N-2207"/></g><g data-mml-node="mrow" transform="translate(866,-150) scale(0.707)"><g data-mml-node="mstyle" fill="#B85450" stroke="#B85450"><g data-mml-node="mi"><use data-c="1D703" xlink:href="#MJX-40-TEX-I-1D703"/></g></g></g></g></g></g></g></svg></mjx-container></span></font></div></div></div></foreignObject><text x="655" y="214" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">`\nabla_{\...</text></switch></g></g></g></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>